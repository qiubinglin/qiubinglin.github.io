---
layout:     post
title:      "Branch Prediction Algorithms"
date:       2024-04-15 21:40:00
author:     "Bing"
catalog:    true
tags:
    - CPU
---

Algorithms list.

# Saturating Counter
饱和计数器（Saturating Counter）是一种简单而高效的分支预测技术，广泛应用于现代处理器的分支预测单元中。

饱和计数器分支预测的核心思想是：
* 使用一个有限位宽的计数器来记录分支指令的历史行为
* 计数器的值反映分支的"倾向性"
* 当计数器达到最大值或最小值时不再变化（即"饱和"）

## 计数器结构
n位饱和计数器：
* 范围：0 到 2ⁿ-1
* 中间值作为阈值

## 预测规则
* 当计数器值 ≥ 阈值时：预测分支采取(Taken)
* 当计数器值 < 阈值时：预测分支不采取(Not Taken)

## 更新规则
当分支被采取时：
* 如果计数器未达到最大值：递增
* 如果已饱和：保持最大值

当分支未被采取时：
* 如果计数器未达到最小值：递减
* 如果已饱和：保持最小值

# 2位饱和计数器（最常用）：
* 00: 强不采取 (Strongly Not Taken)
* 01: 弱不采取 (Weakly Not Taken)
* 10: 弱采取 (Weakly Taken)
* 11: 强采取 (Strongly Taken)

## 实现优势
容错能力：需要多次连续的错误预测才能改变预测方向
* 例如从"11"(强采取)到"10"(弱采取)再到"01"(弱不采取)

稳定性：对偶尔的分支行为变化不敏感
* 单次异常分支不会立即改变预测方向

空间效率：仅需少量存储位即可实现